\documentclass{article}
\usepackage[spanish]{babel}
\usepackage[onehalfspacing]{setspace}
\usepackage[utf8]{inputenc}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{verbatim}
\usepackage{graphicx}
\usepackage{listings}
\usepackage{fullpage}
\usepackage{color}
\usepackage{fancyvrb}
\usepackage{hyperref}
\hypersetup{%
	pdfborder = {0 0 0}
}

\definecolor{mygreen}{rgb}{0,0.6,0}
\definecolor{mygray}{rgb}{0.5,0.5,0.5}
\definecolor{mymauve}{rgb}{0.58,0,0.82}

\lstset{ %
	backgroundcolor=\color{white},   % choose the background color; you must add \usepackage{color} or \usepackage{xcolor}
	basicstyle=\footnotesize,        % the size of the fonts that are used for the code
	breakatwhitespace=false,         % sets if automatic breaks should only happen at whitespace
	breaklines=true,                 % sets automatic line breaking
	captionpos=b,                    % sets the caption-position to bottom
	commentstyle=\color{mygreen},    % comment style
	frame=single,                    % adds a frame around the code
	keepspaces=true,                 % keeps spaces in text, useful for keeping indentation of code (possibly needs columns=flexible)
	numbers=left,                    % where to put the line-numbers; possible values are (none, left, right)
	numbersep=5pt,                   % how far the line-numbers are from the code
	numberstyle=\tiny\color{mygray}, % the style that is used for the line-numbers
	rulecolor=\color{black},         % if not set, the frame-color may be changed on line-breaks within not-black text (e.g. comments (green here))
	showspaces=false,                % show spaces everywhere adding particular underscores; it overrides 'showstringspaces'
	showstringspaces=false,          % underline spaces within strings only
	showtabs=false,                  % show tabs within strings adding particular underscores
	stepnumber=1,                    % the step between two line-numbers. If it's 1, each line will be numbered
	stringstyle=\color{mymauve},     % string literal style
	tabsize=4,
	title=\lstname                   % show the filename of files included with \lstinputlisting; also try caption instead of title
}


\author{José Luis Cánovas Sánchez\\joseluis.canovas2@um.es\\48636907A}
\title{ARQUITECTURAS DE REDES AVANZADAS\\PRÁCTICA 2\\Balanceo de Carga con SDN\\ ENERO 2015}
\date{}
\begin{document}
\maketitle

\begin{abstract}

\end{abstract}

\tableofcontents

\section{Introducción}

\section{Topología mininet}


\begin{lstlisting}[language=Python]
# -*- coding: utf-8 -*-

from mininet.topo import Topo

class MyTopo (Topo):

    def __init__ (self):
        Topo.__init__( self )

        # Add switches
        sw_clients = self.addSwitch('s1')
        sw_servers = self.addSwitch('s2')

        # Add clients
        c1 = self.addHost('cli_1')
        c2 = self.addHost('cli_2')
        c3 = self.addHost('cli_3')
        c4 = self.addHost('cli_4')
        c5 = self.addHost('cli_5')
        c6 = self.addHost('cli_6')

        # Add servers
        s1 = self.addHost('srv_1', ip='10.0.0.101', mac='00:00:00:00:01:01')
        s2 = self.addHost('srv_2', ip='10.0.0.102', mac='00:00:00:00:01:02')
        s3 = self.addHost('srv_3', ip='10.0.0.103', mac='00:00:00:00:01:03')
        s4 = self.addHost('srv_4', ip='10.0.0.104', mac='00:00:00:00:01:04')

        # Add links
        self.addLink(sw_clients, sw_servers, port2=1)

        self.addLink(c1, sw_clients)
        self.addLink(c2, sw_clients)
        self.addLink(c3, sw_clients)
        self.addLink(c4, sw_clients)
        self.addLink(c5, sw_clients)
        self.addLink(c6, sw_clients)

        self.addLink(s1, sw_servers, port2=2)
        self.addLink(s2, sw_servers, port2=3)
        self.addLink(s3, sw_servers, port2=4)
        self.addLink(s4, sw_servers, port2=5)


topos = {'mytopo': lambda: MyTopo()}
\end{lstlisting}

\section{Controlador POX con l2\_learning}


\begin{Verbatim}[frame=single]
$sudo mn --custom topo.py --topo mytopo --controller remote --test pingall
	*** Creating network
	*** Adding controller
	*** Adding hosts:
	cli_1 cli_2 cli_3 cli_4 cli_5 cli_6 srv_1 srv_2 srv_3 srv_4
	*** Adding switches:
	s1 s2
	*** Adding links:
	(cli_1, s1) (cli_2, s1) (cli_3, s1) (cli_4, s1) (cli_5, s1)
	 (cli_6, s1) (s1, s2) (srv_1, s2) (srv_2, s2) (srv_3, s2) (srv_4, s2)
	*** Configuring hosts
	cli_1 cli_2 cli_3 cli_4 cli_5 cli_6 srv_1 srv_2 srv_3 srv_4
	*** Starting controller
	c0
	*** Starting 2 switches
	s1 s2 ...
	*** Waiting for switches to connect
	s1 s2
	*** Ping: testing ping reachability
	cli_1 -> cli_2 cli_3 cli_4 cli_5 cli_6 srv_1 srv_2 srv_3 srv_4
	cli_2 -> cli_1 cli_3 cli_4 cli_5 cli_6 srv_1 srv_2 srv_3 srv_4
	cli_3 -> cli_1 cli_2 cli_4 cli_5 cli_6 srv_1 srv_2 srv_3 srv_4
	cli_4 -> cli_1 cli_2 cli_3 cli_5 cli_6 srv_1 srv_2 srv_3 srv_4
	cli_5 -> cli_1 cli_2 cli_3 cli_4 cli_6 srv_1 srv_2 srv_3 srv_4
	cli_6 -> cli_1 cli_2 cli_3 cli_4 cli_5 srv_1 srv_2 srv_3 srv_4
	srv_1 -> cli_1 cli_2 cli_3 cli_4 cli_5 cli_6 srv_2 srv_3 srv_4
	srv_2 -> cli_1 cli_2 cli_3 cli_4 cli_5 cli_6 srv_1 srv_3 srv_4
	srv_3 -> cli_1 cli_2 cli_3 cli_4 cli_5 cli_6 srv_1 srv_2 srv_4
	srv_4 -> cli_1 cli_2 cli_3 cli_4 cli_5 cli_6 srv_1 srv_2 srv_3
	*** Results: 0\% dropped (90/90 received)
	*** Stopping 1 controllers
	c0
	*** Stopping 11 links
	...........
	*** Stopping 2 switches
	s1 s2
	*** Stopping 10 hosts
	cli_1 cli_2 cli_3 cli_4 cli_5 cli_6 srv_1 srv_2 srv_3 srv_4
	*** Done
	completed in 6.529 seconds
\end{Verbatim}

\section{Construcción del balanceador de carga}

\subsection{Módulo de balanceo en POX}

\subsection{Modificación topología}

\subsection{Ejecución y prueba de PING}

\subsection{Tráfico y flujos}

\section{Anexo}
\begin{Verbatim}
mininet@mininet-vm:~/GitHub/mininet/scripts$ sudo ./testWcont topo.py 
*** Creating network
*** Adding controller
*** Adding hosts:
cli_1 cli_2 cli_3 cli_4 cli_5 cli_6 srv_1 srv_2 srv_3 srv_4
*** Adding switches:
s1 s2
*** Adding links:
(cli_1, s1) (cli_2, s1) (cli_3, s1) (cli_4, s1) (cli_5, s1) (cli_6, s1) (s1, s2) (srv_1, s2) (srv_2, s2) (srv_3, s2) (srv_4, s2)
*** Configuring hosts
cli_1 cli_2 cli_3 cli_4 cli_5 cli_6 srv_1 srv_2 srv_3 srv_4
*** Starting controller
c0
*** Starting 2 switches
s1 s2 ...
*** Starting CLI:
mininet> cli_1 ping -c 4 10.0.0.101
PING 10.0.0.101 (10.0.0.101) 56(84) bytes of data.
64 bytes from 10.0.0.101: icmp_seq=1 ttl=64 time=12.2 ms
64 bytes from 10.0.0.101: icmp_seq=2 ttl=64 time=1.21 ms
64 bytes from 10.0.0.101: icmp_seq=3 ttl=64 time=0.200 ms
64 bytes from 10.0.0.101: icmp_seq=4 ttl=64 time=0.063 ms

--- 10.0.0.101 ping statistics ---
4 packets transmitted, 4 received, 0% packet loss, time 3006ms
rtt min/avg/max/mdev = 0.063/3.441/12.288/5.127 ms
mininet> cli_2 ping -c 4 10.0.0.101
PING 10.0.0.101 (10.0.0.101) 56(84) bytes of data.
64 bytes from 10.0.0.101: icmp_seq=1 ttl=64 time=31.9 ms
64 bytes from 10.0.0.101: icmp_seq=2 ttl=64 time=0.810 ms
64 bytes from 10.0.0.101: icmp_seq=3 ttl=64 time=0.071 ms
64 bytes from 10.0.0.101: icmp_seq=4 ttl=64 time=0.776 ms

--- 10.0.0.101 ping statistics ---
4 packets transmitted, 4 received, 0% packet loss, time 3000ms
rtt min/avg/max/mdev = 0.071/8.392/31.914/13.583 ms
mininet> cli_3 ping -c 4 10.0.0.101
PING 10.0.0.101 (10.0.0.101) 56(84) bytes of data.
64 bytes from 10.0.0.101: icmp_seq=1 ttl=64 time=40.4 ms
64 bytes from 10.0.0.101: icmp_seq=2 ttl=64 time=1.28 ms
64 bytes from 10.0.0.101: icmp_seq=3 ttl=64 time=0.072 ms
64 bytes from 10.0.0.101: icmp_seq=4 ttl=64 time=0.671 ms

--- 10.0.0.101 ping statistics ---
4 packets transmitted, 4 received, 0% packet loss, time 3003ms
rtt min/avg/max/mdev = 0.072/10.614/40.426/17.217 ms
mininet> cli_4 ping -c 4 10.0.0.101
PING 10.0.0.101 (10.0.0.101) 56(84) bytes of data.
64 bytes from 10.0.0.101: icmp_seq=1 ttl=64 time=28.5 ms
64 bytes from 10.0.0.101: icmp_seq=2 ttl=64 time=0.407 ms
64 bytes from 10.0.0.101: icmp_seq=3 ttl=64 time=0.073 ms
64 bytes from 10.0.0.101: icmp_seq=4 ttl=64 time=0.083 ms

--- 10.0.0.101 ping statistics ---
4 packets transmitted, 4 received, 0% packet loss, time 3004ms
rtt min/avg/max/mdev = 0.073/7.284/28.574/12.292 ms
mininet> cli_5 ping -c 4 10.0.0.101
PING 10.0.0.101 (10.0.0.101) 56(84) bytes of data.
64 bytes from 10.0.0.101: icmp_seq=1 ttl=64 time=19.3 ms
64 bytes from 10.0.0.101: icmp_seq=2 ttl=64 time=0.447 ms
64 bytes from 10.0.0.101: icmp_seq=3 ttl=64 time=0.846 ms
64 bytes from 10.0.0.101: icmp_seq=4 ttl=64 time=0.087 ms

--- 10.0.0.101 ping statistics ---
4 packets transmitted, 4 received, 0% packet loss, time 3004ms
rtt min/avg/max/mdev = 0.087/5.178/19.332/8.176 ms
mininet> cli_6 ping -c 4 10.0.0.101
PING 10.0.0.101 (10.0.0.101) 56(84) bytes of data.
64 bytes from 10.0.0.101: icmp_seq=1 ttl=64 time=38.9 ms
64 bytes from 10.0.0.101: icmp_seq=2 ttl=64 time=0.448 ms
64 bytes from 10.0.0.101: icmp_seq=3 ttl=64 time=0.597 ms
64 bytes from 10.0.0.101: icmp_seq=4 ttl=64 time=0.352 ms

--- 10.0.0.101 ping statistics ---
4 packets transmitted, 4 received, 0% packet loss, time 3006ms
rtt min/avg/max/mdev = 0.352/10.082/38.933/16.657 ms
mininet> pingall
*** Ping: testing ping reachability
cli_1 -> cli_2 cli_3 cli_4 cli_5 cli_6 srv_1 srv_2 srv_3 srv_4
cli_2 -> cli_1 cli_3 cli_4 cli_5 cli_6 srv_1 srv_2 srv_3 srv_4
cli_3 -> cli_1 cli_2 cli_4 cli_5 cli_6 srv_1 srv_2 srv_3 srv_4
cli_4 -> cli_1 cli_2 cli_3 cli_5 cli_6 srv_1 srv_2 srv_3 srv_4
cli_5 -> cli_1 cli_2 cli_3 cli_4 cli_6 srv_1 srv_2 srv_3 srv_4
cli_6 -> cli_1 cli_2 cli_3 cli_4 cli_5 srv_1 srv_2 srv_3 srv_4
srv_1 -> cli_1 X X X cli_5 X srv_2 srv_3 srv_4
srv_2 -> X cli_2 X X X cli_6 srv_1 srv_3 srv_4
srv_3 -> X X cli_3 X X X srv_1 srv_2 srv_4
srv_4 -> X X X cli_4 X X srv_1 srv_2 srv_3
*** Results: 20% dropped (72/90 received)
mininet> dpctl dump-flows
*** s1 ------------------------------------------------------------------------
NXST_FLOW reply (xid=0x4):
*** s2 ------------------------------------------------------------------------
NXST_FLOW reply (xid=0x4):
 cookie=0x0, duration=390.693s, table=0, n_packets=24, n_bytes=1512, idle_age=309, dl_src=fe:1c:e8:bb:47:2b actions=output:4
 cookie=0x0, duration=397.979s, table=0, n_packets=25, n_bytes=1554, idle_age=312, dl_src=5a:fb:3a:24:c3:d0 actions=output:3
 cookie=0x0, duration=368.291s, table=0, n_packets=21, n_bytes=1386, idle_age=303, dl_src=26:1a:ac:72:e4:51 actions=output:3
 cookie=0x0, duration=383.206s, table=0, n_packets=23, n_bytes=1470, idle_age=303, dl_src=ba:d3:b1:08:9d:20 actions=output:5
 cookie=0x0, duration=406.713s, table=0, n_packets=26, n_bytes=1596, idle_age=315, dl_src=86:bd:bc:16:52:e3 actions=output:2
 cookie=0x0, duration=376.218s, table=0, n_packets=21, n_bytes=1386, idle_age=306, dl_src=ca:6d:f2:8c:c1:a9 actions=output:2
mininet> cli_1 ifconfig
cli_1-eth0 Link encap:Ethernet  HWaddr 86:bd:bc:16:52:e3
          inet addr:10.0.0.1  Bcast:10.255.255.255  Mask:255.0.0.0
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:101 errors:0 dropped:0 overruns:0 frame:0
          TX packets:41 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000
          RX bytes:5306 (5.3 KB)  TX bytes:2786 (2.7 KB)

lo        Link encap:Local Loopback
          inet addr:127.0.0.1  Mask:255.0.0.0
          UP LOOPBACK RUNNING  MTU:65536  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0
          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)

mininet> cli_2 ifconfig
cli_2-eth0 Link encap:Ethernet  HWaddr 5a:fb:3a:24:c3:d0
          inet addr:10.0.0.2  Bcast:10.255.255.255  Mask:255.0.0.0
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:101 errors:0 dropped:0 overruns:0 frame:0
          TX packets:41 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000
          RX bytes:5306 (5.3 KB)  TX bytes:2786 (2.7 KB)

lo        Link encap:Local Loopback
          inet addr:127.0.0.1  Mask:255.0.0.0
          UP LOOPBACK RUNNING  MTU:65536  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0
          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)

mininet> cli_3 ifconfig
cli_3-eth0 Link encap:Ethernet  HWaddr fe:1c:e8:bb:47:2b
          inet addr:10.0.0.3  Bcast:10.255.255.255  Mask:255.0.0.0
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:101 errors:0 dropped:0 overruns:0 frame:0
          TX packets:41 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000
          RX bytes:5306 (5.3 KB)  TX bytes:2786 (2.7 KB)

lo        Link encap:Local Loopback
          inet addr:127.0.0.1  Mask:255.0.0.0
          UP LOOPBACK RUNNING  MTU:65536  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0
          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)

mininet> cli_4 ifconfig
cli_4-eth0 Link encap:Ethernet  HWaddr ba:d3:b1:08:9d:20
          inet addr:10.0.0.4  Bcast:10.255.255.255  Mask:255.0.0.0
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:101 errors:0 dropped:0 overruns:0 frame:0
          TX packets:41 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000
          RX bytes:5306 (5.3 KB)  TX bytes:2786 (2.7 KB)

lo        Link encap:Local Loopback
          inet addr:127.0.0.1  Mask:255.0.0.0
          UP LOOPBACK RUNNING  MTU:65536  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0
          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)

mininet> cli_5 ifconfig
cli_5-eth0 Link encap:Ethernet  HWaddr ca:6d:f2:8c:c1:a9
          inet addr:10.0.0.5  Bcast:10.255.255.255  Mask:255.0.0.0
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:100 errors:0 dropped:0 overruns:0 frame:0
          TX packets:40 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000
          RX bytes:5264 (5.2 KB)  TX bytes:2744 (2.7 KB)

lo        Link encap:Local Loopback
          inet addr:127.0.0.1  Mask:255.0.0.0
          UP LOOPBACK RUNNING  MTU:65536  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0
          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)

mininet> cli_6 ifconfig
cli_6-eth0 Link encap:Ethernet  HWaddr 26:1a:ac:72:e4:51
          inet addr:10.0.0.6  Bcast:10.255.255.255  Mask:255.0.0.0
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:101 errors:0 dropped:0 overruns:0 frame:0
          TX packets:41 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000
          RX bytes:5306 (5.3 KB)  TX bytes:2786 (2.7 KB)

lo        Link encap:Local Loopback
          inet addr:127.0.0.1  Mask:255.0.0.0
          UP LOOPBACK RUNNING  MTU:65536  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0
          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)

mininet>

\end{Verbatim}

\begin{thebibliography}{99}


\end{thebibliography}


\end{document}
